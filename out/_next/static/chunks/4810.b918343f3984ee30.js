"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4810],{4810:function(e,t,n){n.r(t);var r=n(4051),s=n.n(r),i=n(5893),a=n(5988),c=n.n(a),o=n(7294),f=n(5152),u=n(5588),l=n(381),p=n.n(l),d=n(1819);function x(e,t,n,r,s,i,a){try{var c=e[i](a),o=c.value}catch(f){return void n(f)}c.done?t(o):Promise.resolve(o).then(r,s)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(r,s){var i=e.apply(t,n);function a(e){x(i,r,s,a,c,"next",e)}function c(e){x(i,r,s,a,c,"throw",e)}a(void 0)}))}}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function w(e,t){return!t||"object"!==y(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b(e,t){return b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},b(e,t)}var y=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function j(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m(e);if(t){var s=m(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return w(this,n)}}var k=(0,f.default)((function(){return Promise.all([n.e(7084),n.e(3966)]).then(n.bind(n,3966))}),{loadableGenerated:{webpack:function(){return[3966]}}}),g=(0,f.default)((function(){return Promise.all([n.e(7084),n.e(4226)]).then(n.bind(n,4226))}),{loadableGenerated:{webpack:function(){return[4226]}}}),O=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(o,e);var t,n,r,a=j(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this,e)).state={items:null,activeView:e.defaultView||"news"},t}return t=o,(n=[{key:"componentDidMount",value:function(){var e=this;return h(s().mark((function t(){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("news"!==e.state.activeView){t.next=6;break}return t.next=3,e.fetchNews();case 3:t.t0=t.sent,t.next=9;break;case 6:return t.next=8,e.fetchEvents();case 8:t.t0=t.sent;case 9:n=t.t0,e.setState({items:n});case 11:case"end":return t.stop()}}),t)})))()}},{key:"fetchNews",value:function(){var e=this;return h(s().mark((function t(){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,(0,d.dD)();case 3:return n=t.sent,n=e.formatItems(n),n=e.filterItems(n),n=e.sortItems(n),t.abrupt("return",n);case 8:case"end":return t.stop()}}),t)})))()}},{key:"fetchEvents",value:function(){var e=this;return h(s().mark((function t(){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,(0,d.vw)();case 3:return n=t.sent,n=e.formatItems(n),n=e.getFutureItemsOnly(n),n=e.filterItems(n),n=e.sortItems(n),t.abrupt("return",n);case 9:case"end":return t.stop()}}),t)})))()}},{key:"formatItems",value:function(e){return u.UID((function(e){return Object.assign({},e.fields,{datetime:e.sys.createdAt})}),e)}},{key:"filterItems",value:function(e){return e=u.tPi(0,this.props.limit||20,e)}},{key:"sortItems",value:function(e){return e}},{key:"getFutureItemsOnly",value:function(e){return u.hXT((function(e){return p()(e.publishDate).diff(p()(),"days")>=0}),e)}},{key:"clickFilter",value:function(e){var t=this;return h(s().mark((function n(){var r;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.setState({activeView:e}),"news"!==e){n.next=6;break}return n.next=5,t.fetchNews();case 5:r=n.sent;case 6:if("events"!==e){n.next=10;break}return n.next=9,t.fetchEvents();case 9:r=n.sent;case 10:t.setState({items:r});case 11:case"end":return n.stop()}}),n)})))()}},{key:"render",value:function(){var e=this,t=this,n=u.hXT((function(e){return"/happening"===e.slug||document.location.pathname.indexOf(e.slug)<=-1}),this.state.items||{});return this.state.items?(0,i.jsxs)("div",{className:"jsx-e6ec9f22c187ad64 HappeningOverview flex flex-wrap flex-start",children:[(0,i.jsx)("nav",{className:"jsx-e6ec9f22c187ad64 filters show-on-desktop-only",children:(0,i.jsxs)("ul",{className:"jsx-e6ec9f22c187ad64",children:[(0,i.jsx)("li",{className:"jsx-e6ec9f22c187ad64 "+(("news"===this.state.activeView?"is-active":"")||""),children:(0,i.jsx)("a",{onClick:this.clickFilter.bind(this,"news"),className:"jsx-e6ec9f22c187ad64",children:"News from TPY"})}),(0,i.jsx)("li",{className:"jsx-e6ec9f22c187ad64 "+(("events"===this.state.activeView?"is-active":"")||""),children:(0,i.jsx)("a",{onClick:this.clickFilter.bind(this,"events"),className:"jsx-e6ec9f22c187ad64",children:"Programmes & Events"})})]})}),(0,i.jsx)("div",{className:"jsx-e6ec9f22c187ad64 items",children:u.UID((function(n){var r=e.state.items[n];return"events"===t.state.activeView?(0,i.jsx)(g,{event:r},n):(0,i.jsx)(k,{event:r},n)}),Object.keys(n))}),(0,i.jsx)(c(),{id:"e6ec9f22c187ad64",children:".HappeningOverview.jsx-e6ec9f22c187ad64{width:1e3px;max-width:100%;margin:0 auto 48px}.items.jsx-e6ec9f22c187ad64{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-flex:1;-ms-flex:1;flex:1}.filters.jsx-e6ec9f22c187ad64{width:300px;max-width:100%;margin-top:20px;padding:0 18px}.filters.jsx-e6ec9f22c187ad64 ul.jsx-e6ec9f22c187ad64,.filters.jsx-e6ec9f22c187ad64 li.jsx-e6ec9f22c187ad64{list-style:none;margin:0;padding:0}.filters.jsx-e6ec9f22c187ad64 li.jsx-e6ec9f22c187ad64{margin:10px 0}.filters.jsx-e6ec9f22c187ad64 a.jsx-e6ec9f22c187ad64{cursor:pointer;font-family:Montserrat,sans-serif;font-style:normal;font-weight:500;font-size:16px;line-height:24px;letter-spacing:.5px;text-decoration:none;color:rgba(20,67,114,.5);border-bottom:solid transparent 8px}.filters.jsx-e6ec9f22c187ad64 li.is-active.jsx-e6ec9f22c187ad64 a.jsx-e6ec9f22c187ad64{color:#144372;cursor:cursor;display:inline-block;padding-bottom:6px;border-bottom:solid#ff8850 8px}"})]}):(0,i.jsx)("div",{style:{minHeight:"800px"}})}}])&&v(t.prototype,n),r&&v(t,r),o}(o.Component);t.default=O}}]);